#include "includes.h"

const size_t map_w = 46;
const size_t map_h = 88;
const char map_c_empty = ' ';

const char map_test[] = "\
1111111111111111111111111111111111111111111111\
1222222222222222221        1222222222222222221\
12                1        1                21\
12                1                         21\
12                1                         21\
12  oip           1        1111111111111111111\
12                v        1222222221222222221\
1111111111111111111        v       21       21\
1222222222222222221        1       21       21\
12                1        1111111111       21\
12                1        1222222222       21\
12                1        v                21\
12                1        1                21\
12                v        1                21\
1111111111111111111        1111111111111111111\
1222222222222222221        2222222222222222221\
12                1                         21\
12                1        1                21\
12   luuuuuuuuk   1        1                21\
12   oiiiiiiiip   1        1                21\
12                v        1                21\
1111111111111111111        1                21\
1222222222222222221        1                21\
12                1        1                21\
12                1        1                21\
12                1                         21\
12                1        1                21\
12                v        1                21\
1111111111111111111        1                21\
1222222222221222222        1                21\
12          12             1                21\
12          12             1                21\
12          12             1                21\
12          12                              21\
12          v                               21\
1111111111111c             1111111111111111111\
12222222222212             2222222222222222221\
12          12             v                21\
12          12             1                21\
12          12             1                21\
12          12             1                21\
12          v              1                21\
1111111111111c             1                21\
12222222222212             1                21\
12          12             1                21\
12          12             1                21\
12          12             1                21\
12          12             v                21\
12          v              1                21\
1111111111111111111        1111111111111111111\
1222222222222222221        2222222222222222221\
12                v                         21\
12                1        1                21\
12                1        1                21\
12                1        1                21\
12                1        1                21\
1111111111111111111        1                21\
1222222222222222221        1                21\
12                v        1                21\
12                1        1                21\
12                1                         21\
12                1        1111111111111111111\
12                1        1222222222222222221\
1111111111111111111        1                21\
1222222222222222221        1                21\
12                v        1                21\
12                1        v                21\
12                1        1111111111111111111\
12                1        1222222222222222221\
12                1        1                21\
1111111111111111111        v                21\
1222222222222222222        1                21\
12                         1                21\
12                         1                21\
12                         1111111111111111111\
12                         2222222222222222221\
12                                          21\
12                                          21\
12                                          21\
12                                          21\
12                                          21\
12                                          21\
1111111111111111111111111111111111111111111111\
                                              \
                                              \
";


const char map[] = "\
1111111111111111111111111111111111111111111111\
1                 1        1                 1\
1                 1        1                 1\
1                 1                          1\
1                 1                          1\
1                 1        1111111111111111111\
1                          1        1        1\
1111111111111111111        1        1        1\
1                 1                 1        1\
1                 1        1111111111        1\
1                 1                          1\
1                 1        1                 1\
1                 1        1                 1\
1                          1                 1\
1111111111111111111        1111111111111111111\
1                 1                          1\
1                 1                          1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                          1                 1\
1111111111111111111        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                          1                 1\
1111111111111111111        1                 1\
1           1              1                 1\
1           1              1                 1\
1           1              1                 1\
1           1              1                 1\
1           1                                1\
1                                            1\
1111111111111c             1111111111111111111\
1           1                                1\
1           1                                1\
1           1              1                 1\
1           1              1                 1\
1           1              1                 1\
1                          1                 1\
1111111111111c             1                 1\
1           1              1                 1\
1           1              1                 1\
1           1              1                 1\
1           1              1                 1\
1           1                                1\
1                                            1\
1111111111111111111        1111111111111111111\
1                                            1\
1                 1                          1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                 1        1                 1\
1111111111111111111        1                 1\
1                          1                 1\
1                 1        1                 1\
1                 1        1                 1\
1                 1                          1\
1                 1        1111111111111111111\
1                 1        1                 1\
1111111111111111111        1                 1\
1                          1                 1\
1                 1        1                 1\
1                 1                          1\
1                 1        1111111111111111111\
1                 1        1                 1\
1                 1        1                 1\
1111111111111111111                          1\
1     1           1        1                 1\
1     1           1        1                 1\
1     1                    1                 1\
1111  1111111111111        1111111111111111111\
1                                            1\
1                                            1\
1                                            1\
1                                            1\
1                                            1\
1                                            1\
1                                            1\
1111111111111111111111111    1               1\
2                            1               1\
2                            1               1\
2                            1               1\
2                            1               1\
2222222222222222222222222222211111111111111111\
                                              \
                                              \
";


int init_map(Game *game, const char *mapStr){
	game->map.map_len = strlen(mapStr);
	game->map.map = (char *)malloc(sizeof(char) * game->map.map_len + 1); // Assigner la carte au jeu
	strcpy(game->map.map, mapStr);

	int nb_doors = 0;
	for(int i = 0; i < game->map.map_len; i++){
		if (game->map.map[i] == 'v' || game->map.map[i] == 'h'){
			game->map.doors[nb_doors].enabled = 1;
			game->map.doors[nb_doors].y = i / map_w;
			game->map.doors[nb_doors].x = i % map_w;
			game->map.doors[nb_doors].state = 0;
			if (game->map.map[i] == 'v'){
				game->map.doors[nb_doors].vertical = 1;
			} else {
				game->map.doors[nb_doors].vertical = 0;
			}
			// game->map.map[i] = map_c_empty;
			nb_doors++;
		}
		if (nb_doors > 20) return -1;
	}
	game->map.nb_doors = nb_doors;

	game->map.w = map_w; // Assigner la largeur de la carte
	game->map.h = map_h; // Assigner la hauteur de la carte
	game->map.map_c_empty = map_c_empty; // Assigner le caract√®re vide de la carte

	return 0;
}

